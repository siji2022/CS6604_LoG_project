# Graph-Based Anomaly Detection and Predictive Modeling on Sensor Networks
The course project of Virginia Tech CS6604 Learnign on Graph
#### Daodao Zhou, Jianger Yu and Siji Chen

## Overview
In this project, we aim to leverage Large Language Model(LLM) to analyze anomaly in the "Motes dataset" [6 ], which was collected from 54 sensors deployed at the Intel Berkeley Research Lab between February 28th and April 5th, 2004.

Our results show: 
- LLMs can effectively detect anomalies in the given dataset.
- Among the LLM variants tested, GPT-4o-mini demonstrated slightly better performance for temperature anomaly detection. When using the straight forward prompts e.g. Vanilla and Chain of Thought (COT), which achieved the highest F1 scores of 0.91. For humidity and voltage GPT-4 has better performance.
- All LLM models outperformed traditional methods (KDE and Seasonal Decomposition) in our experiments. KDE also took hours to complete and timeout when using it as assignment method.
## Results highlight

|| **Metric**  | **LLM**     | **Kernel Density Estimation**     | **Seasonal Decomposition**      |
|-------------|-------------|-------------|-------------|-------------|
| **Temperature** | AUC   | **0.99**    | 0.56        | 0.93       |
|               | AP    | 0.84        | 0.14        | **0.87**   |
|               | F1    | 0.91        | 0.23        | **0.93**   |
| **Humidity**    | AUC   | **0.92**    | 0.56        | 0.89       |
|               | AP    | **0.83**    | 0.1         | 0.78       |
|               | F1    | **0.91**    | 0.21        | 0.87       |
| **Voltage**     | AUC   | **1**       | 0.62        | 0.92       |
|               | AP    | **0.71**    | 0.24        | 0.46       |
|               | F1    | **0.83**    | 0.38        | 0.66       |
## Files
The `/data/` directory contains the following files:
- `/results`: ChatGPT and GPT results for prompt strategies: Vanilla, COT, Few-Shots
- `labapp3*`: Original dataset from Motes dataset
- `data_selection_17_23*.csv`: the selected date for analysis in this project
- `manual_label.csv`: the groud truth we manually labeled after carefully analyze the dataset.
- `*_anomalies.csv`: the predictions by seasonal decomposition
- `anomalous_*.csv`: the predictions by KDE 

The `/trainditonal_approach/` directory contains files for KDE/SD methods and its results.

The files under root directory:
- `result_analysis.ipynb`: analyze the results generated by varies models
- `manual_labeling.ipynb`: manually create the labels.
- `prompt2024.ipynb`: GPT API code
- `position_analysis.ipynb`: spatial analysis
- `ead.ipynb`: Exploratory data analysis

## How to Use
1. Clone this repository to your local machine. We use python=3.9.
2. unzip `/data/lapapp3-data-new.zip`
3. run eda.ipynb to see the original dataset
4. run result_analysis.ipynb to see the overall results.




